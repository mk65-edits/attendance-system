<style>
/* ----------------- Navbar & Sidebar Overlay ----------------- */
.navbar {
  font-family: 'Times New Roman', Times, serif;
  transition: all 0.3s ease;
  z-index: 3000 !important;
}

/* Brand */
.navbar .navbar-brand { font-size: 1.1rem; white-space: nowrap; }

/* Text & Links */
.navbar .text-light, .navbar .nav-link { font-size: 0.95rem; white-space: nowrap; }
.navbar .nav-link i { margin-right: 4px; }

/* Padding for fixed-top navbar */
body { padding-top: 56px; }

/* Sidebar overlay styles for mobile */
.expanded-mobile {
  transform: translateX(0) !important;
  position: fixed;
  top: 0;
  left: 0;
  height: 100%;
  width: 200px; /* expanded width */
  z-index: 2000;
  box-shadow: 2px 0 12px rgba(0,0,0,0.25);
  background: var(--sidebar-bg, #0f1724);
  transition: transform 0.3s ease, width 0.3s ease;
}

body.no-scroll { overflow: hidden; }

/* Desktop: keep normal margins */
@media (min-width: 768px) {
  .expanded-mobile { transform: translateX(0) !important; position: relative; box-shadow: none; }
}
</style>

<nav class="navbar navbar-dark bg-dark fixed-top shadow-sm py-2">
  <div class="container-fluid d-flex justify-content-between align-items-center">

    <!-- Left side -->
    <div class="d-flex align-items-center">
      <!-- Mobile Sidebar Toggle -->
      <button class="btn btn-outline-light d-lg-none me-2" id="sidebarToggleMobile" type="button">
        <i class="bi bi-list"></i>
      </button>

      <!-- Brand -->
      <a class="navbar-brand fw-semibold" href="/">ðŸ›œ Office Connect</a>
    </div>

    <!-- Right side -->
    <div class="d-flex align-items-center flex-wrap text-end">
      <span class="text-light me-3 fw-semibold">{{ current_user.role|capitalize }}</span>
      <a class="nav-link text-danger fw-semibold d-flex align-items-center" href="{{ url_for('auth.logout') }}">
        <i class="bi bi-box-arrow-right"></i> Logout
      </a>
    </div>
  </div>
</nav>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const sidebar = document.getElementById("sharedSidebar");
  const toggleBtn = document.getElementById("sidebarToggleMobile");
  const body = document.body;

  if (toggleBtn && sidebar) {
    toggleBtn.addEventListener("click", (e) => {
      e.stopPropagation(); // prevent immediate closing
      sidebar.classList.toggle("expanded-mobile");
      body.classList.toggle("no-scroll");
    });

    // Close sidebar when clicking outside
    document.addEventListener("click", (e) => {
      if (window.innerWidth <= 768 && sidebar.classList.contains("expanded-mobile")) {
        const isClickInside = sidebar.contains(e.target) || toggleBtn.contains(e.target);
        if (!isClickInside) {
          sidebar.classList.remove("expanded-mobile");
          body.classList.remove("no-scroll");
        }
      }
    });

    // Optional: close sidebar on resize > 768
    window.addEventListener("resize", () => {
      if (window.innerWidth > 768 && sidebar.classList.contains("expanded-mobile")) {
        sidebar.classList.remove("expanded-mobile");
        body.classList.remove("no-scroll");
      }
    });
  }
});
</script>
