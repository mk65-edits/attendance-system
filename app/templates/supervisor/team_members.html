{% extends "dashboard_base.html" %}
{% block title %}Team Members{% endblock %}

{% block dashboard_content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  .table th, .table td {
      vertical-align: middle !important;
  }

  .card {
      border-radius: 10px;
  }

  .page-header {
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
  }

  .badge {
      font-size: 0.85rem;
  }

  @media (max-width: 768px) {
      table thead {
          display: none;
      }
      table tbody tr {
          display: block;
          margin-bottom: 1rem;
          border: 1px solid #ddd;
          border-radius: 10px;
          padding: 0.5rem;
      }
      table tbody td {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.4rem 0.6rem;
          border: none !important;
      }
      table tbody td::before {
          content: attr(data-label);
          font-weight: 600;
          color: #333;
      }
  }
</style>

<div class="container-fluid py-4">

  <!-- ðŸ”¹ Header -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 page-header">
      <h4 class="mb-2 mb-md-0"><i class="bi bi-people-fill"></i> Team Members Overview</h4>
  </div>

  <!-- ðŸ”¹ Table -->
  <div class="card shadow-sm">
      <div class="card-body p-3">
          <div class="table-responsive">
              <table class="table table-striped table-bordered align-middle text-nowrap mb-0">
                  <thead class="table-dark text-center">
                      <tr>
                          <th>#</th>
                          <th>Full Name</th>
                          <th>Username</th>
                          <th>Created</th>
  <!--                    <th>Basic Salary</th>-->
                          <th>Travel </th>
<!--                      <th>Presents</th>
                          <th>Lates</th>
                          <th>Penalties (PKR)</th>
                          <th>Bonuses (PKR)</th>
                          <th>Final Salary (PKR)</th>-->
                          <th>Action</th>
                      </tr>
                  </thead>
                  <tbody>
                      {% for user in users %}
                      {% set summary = attendance_summary.get(user.id, {}) %}
                      <tr>
                          <td data-label="#"> {{ loop.index }} </td>
                          <td data-label="Full Name">{{ user.user_full_name() }}</td>
                          <td data-label="Username">{{ user.username }}</td>
                          <td data-label="Created">{{ user.created_at.strftime('%Y-%m-%d') }}</td>
  <!--                    <td data-label="Basic Salary">PKR {{ "{:,.2f}".format(user.salary or 0) }}</td>   -->
                          <td data-label="Travel Allowance">
                              {% if user.travel_allowance_eligible %}
                                  <span class="badge bg-success">Yes</span>
                              {% else %}
                                  <span class="badge bg-secondary">No</span>
                              {% endif %}
                          </td>
 <!--                     <td data-label="Presents">
                              <span class="badge bg-primary">{{ summary.presents or 0 }}</span>
                          </td>
                          <td data-label="Lates">
                              <span class="badge bg-warning text-dark">{{ summary.lates or 0 }}</span>
                          </td>
                         <td data-label="Penalties">PKR {{ "{:,.2f}".format(summary.penalties or 0) }}</td>
                          <td data-label="Bonuses">PKR {{ "{:,.2f}".format(summary.bonuses or 0) }}</td>
                          <td data-label="Final Salary">
                              <strong>PKR {{ "{:,.2f}".format(summary.calculated_salary or (user.salary or 0)) }}</strong>
                          </td>  -->
                          <td data-label="Action" class="text-center">
                              <a href="{{ url_for('supervisor.user_details', user_id=user.id) }}" class="btn btn-sm btn-outline-primary">
                                  <i class="bi bi-eye"></i> View
                              </a>
                          </td>
                      </tr>
                      {% else %}
                      <tr>
                          <td colspan="12" class="text-center text-muted py-3">No users found for this shift.</td>
                      </tr>
                      {% endfor %}
                  </tbody>
          </table>
          </div>
      </div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
